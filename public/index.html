<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="facebook-domain-verification" content="nhtlwpx5azsslibe836spfqtbzqad8" />
    <title>DU Clinic - ‡∏®‡∏±‡∏•‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡πÑ‡∏ó‡∏¢</title>

    <!-- Google Fonts - Prompt for Thai -->
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Facebook Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
    n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}
    (window, document,'script','https://connect.facebook.net/en_US/fbevents.js');

    fbq('init','3372319072916447');
    fbq('track','PageView');
    console.log('üì± Facebook Pixel Ï¥àÍ∏∞Ìôî ÏôÑÎ£å - Pixel ID: 3372319072916447');
    </script>
    <noscript>
      <img height="1" width="1" style="display:none"
           src="https://www.facebook.com/tr?id=3372319072916447&ev=PageView&noscript=1" />
    </noscript>
    <!-- End Facebook Pixel Code -->

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Prompt', sans-serif;
            line-height: 1.7;
            color: #2d2d2d;
            background: #f8f9fa;
            padding-bottom: 100px;
        }

        /* ========== HERO SECTION ========== */
        .hero {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: white;
            padding: 60px 20px 80px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="none" stroke="rgba(255,255,255,0.03)" stroke-width="0.5"/></svg>');
            background-size: 50px 50px;
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 600px;
            margin: 0 auto;
        }

        .hero h1 {
            font-size: 1.8rem;
            font-weight: 600;
            line-height: 1.4;
            margin-bottom: 20px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .hero p {
            font-size: 1.05rem;
            color: rgba(255,255,255,0.85);
            font-weight: 300;
            max-width: 450px;
            margin: 0 auto;
        }

        /* ========== HEADER IMAGE SECTION ========== */
        .header-image-section {
            background: linear-gradient(180deg, #0f3460 0%, #1a1a2e 100%);
            padding: 0 20px 40px;
        }

        .header-image-container {
            max-width: 400px;
            margin: 0 auto;
        }

        .header-video {
            width: 100%;
            aspect-ratio: 9/16;
            border-radius: 15px;
            border: none;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        /* ========== TRUST SECTION ========== */
        .trust-section {
            background: white;
            padding: 50px 20px;
            margin-top: -30px;
            border-radius: 30px 30px 0 0;
            position: relative;
            z-index: 2;
        }

        .trust-title {
            text-align: center;
            font-size: 1.3rem;
            font-weight: 600;
            color: #1a1a2e;
            margin-bottom: 35px;
        }

        .trust-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            max-width: 600px;
            margin: 0 auto;
        }

        .trust-item {
            text-align: center;
            padding: 25px 10px;
            background: linear-gradient(145deg, #f8f9fa, #ffffff);
            border-radius: 16px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: transform 0.3s ease;
        }

        .trust-item:hover {
            transform: translateY(-5px);
        }

        .trust-icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
        }

        .trust-item h3 {
            font-size: 0.85rem;
            font-weight: 600;
            color: #1a1a2e;
            margin-bottom: 8px;
        }

        .trust-item p {
            font-size: 0.75rem;
            color: #666;
            line-height: 1.5;
        }

        /* ========== REVIEW SECTION ========== */
        .review-section {
            background: #f8f9fa;
            padding: 50px 20px;
        }

        .review-title {
            text-align: center;
            font-size: 1.3rem;
            font-weight: 600;
            color: #1a1a2e;
            margin-bottom: 10px;
        }

        .review-subtitle {
            text-align: center;
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 30px;
        }

        .review-slider {
            max-width: 600px;
            margin: 0 auto;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .review-slider::-webkit-scrollbar {
            display: none;
        }

        .review-track {
            display: flex;
            gap: 15px;
            padding: 10px 5px;
        }

        .review-card {
            flex: 0 0 280px;
            scroll-snap-align: center;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
        }

        .review-images {
            width: 100%;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 2px;
        }

        .review-images img {
            width: 100%;
            height: 120px;
            object-fit: cover;
        }

        .review-labels {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
            padding: 0 10px;
        }

        .review-label-group {
            text-align: center;
        }

        .review-label-group .review-tag {
            display: inline-block;
            margin-bottom: 8px;
        }

        .review-label-group .review-text {
            font-size: 14px;
            color: #666;
            margin: 0;
        }

        .review-content {
            padding: 20px;
        }

        .review-tag {
            display: inline-block;
            background: linear-gradient(135deg, #d4af37, #f4d03f);
            color: #1a1a2e;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .review-text {
            font-size: 0.9rem;
            color: #444;
            line-height: 1.6;
        }

        .review-author {
            margin-top: 12px;
            font-size: 0.8rem;
            color: #888;
        }

        /* ========== PROMO SECTION ========== */
        .promo-section {
            background: white;
            padding: 40px 20px;
            text-align: center;
        }

        .promo-box {
            max-width: 500px;
            margin: 0 auto;
            background: linear-gradient(135deg, #fff9e6, #fff5d6);
            border: 2px solid #d4af37;
            border-radius: 20px;
            padding: 30px 25px;
        }

        .promo-badge {
            display: inline-block;
            background: #d4af37;
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .promo-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #1a1a2e;
            margin-bottom: 10px;
        }

        .promo-list {
            text-align: left;
            max-width: 300px;
            margin: 20px auto;
        }

        .promo-list li {
            list-style: none;
            padding: 8px 0;
            font-size: 0.95rem;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .promo-list li::before {
            content: '‚úì';
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 22px;
            height: 22px;
            background: #28a745;
            color: white;
            border-radius: 50%;
            font-size: 0.75rem;
            font-weight: bold;
        }

        /* ========== STICKY CTA ========== */
        .sticky-cta {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #00c851, #00a844);
            padding: 15px 20px;
            z-index: 1000;
            box-shadow: 0 -5px 30px rgba(0,0,0,0.2);
        }

        .sticky-cta-content {
            max-width: 500px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
        }

        .sticky-cta-text {
            color: white;
            flex: 1;
        }

        .sticky-cta-text .highlight {
            font-size: 0.75rem;
            background: rgba(255,255,255,0.2);
            padding: 3px 10px;
            border-radius: 12px;
            display: inline-block;
            margin-bottom: 5px;
        }

        .sticky-cta-text .main-text {
            font-size: 0.95rem;
            font-weight: 600;
        }

        .sticky-cta-button {
            display: flex;
            align-items: center;
            gap: 8px;
            background: white;
            color: #00a844;
            padding: 14px 24px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 700;
            font-size: 1rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
            white-space: nowrap;
        }

        .sticky-cta-button:hover {
            transform: scale(1.05);
        }

        .sticky-cta-button svg {
            width: 24px;
            height: 24px;
        }

        /* ========== RESPONSIVE ========== */
        @media (max-width: 480px) {
            .hero h1 {
                font-size: 1.5rem;
            }

            .trust-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .trust-item {
                display: flex;
                align-items: center;
                text-align: left;
                padding: 18px 20px;
                gap: 15px;
            }

            .trust-icon {
                font-size: 2rem;
                margin-bottom: 0;
            }

            .trust-item-content {
                flex: 1;
            }

            .sticky-cta-content {
                flex-direction: column;
                text-align: center;
            }

            .sticky-cta-button {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>

    <!-- ========== HERO SECTION ========== -->
    <section class="hero">
        <div class="hero-content">
            <h1>‡∏®‡∏±‡∏•‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ<br>‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÇ‡∏Ñ‡∏£‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡∏ô‡πÑ‡∏ó‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h1>
            <p>‡∏Ñ‡∏∏‡∏ì‡∏´‡∏°‡∏≠‡∏Ñ‡∏¥‡∏°‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏≠‡∏á 1:1 ‡∏ó‡∏∏‡∏Å‡πÄ‡∏Ñ‡∏™<br>‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏®‡∏±‡∏•‡∏¢‡∏Å‡∏£‡∏£‡∏°</p>
        </div>
    </section>

    <!-- ========== HEADER VIDEO SECTION ========== -->
    <section class="header-image-section">
        <div class="header-image-container">
            <video class="header-video" autoplay muted loop playsinline>
                <source src="/header-video.mp4" type="video/mp4">
            </video>
        </div>
    </section>

    <!-- ========== TRUST SECTION ========== -->
    <section class="trust-section">
        <h2 class="trust-title">‡∏ó‡∏≥‡πÑ‡∏°‡∏Ñ‡∏ô‡πÑ‡∏ó‡∏¢‡∏ñ‡∏∂‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å DU Clinic?</h2>

        <div class="trust-grid">
            <div class="trust-item">
                <div class="trust-icon">üìπ</div>
                <div class="trust-item-content">
                    <h3>CCTV Safe</h3>
                    <p>‡∏°‡∏µ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ß‡∏á‡∏à‡∏£‡∏õ‡∏¥‡∏î (CCTV) ‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î</p>
                </div>
            </div>

            <div class="trust-item">
                <div class="trust-icon">üáπüá≠</div>
                <div class="trust-item-content">
                    <h3>Thai Care</h3>
                    <p>‡∏•‡πà‡∏≤‡∏°‡πÑ‡∏ó‡∏¢‡∏î‡∏π‡πÅ‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß ‡∏ï‡∏•‡∏≠‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤</p>
                </div>
            </div>

            <div class="trust-item">
                <div class="trust-icon">‚ö°</div>
                <div class="trust-item-content">
                    <h3>Fast Recovery</h3>
                    <p>‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î‡∏®‡∏∏‡∏Å‡∏£‡πå ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</p>
                </div>
            </div>
        </div>
    </section>

    <!-- ========== REVIEW SECTION ========== -->
    <section class="review-section">
        <h2 class="review-title">‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ô‡πÑ‡∏ó‡∏¢‡πÉ‡∏ô‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ</h2>
        <p class="review-subtitle">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏ô‡πÑ‡∏ó‡∏¢</p>

        <div class="review-images">
            <img src="/review-1.png" alt="Image 1" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 120%22><rect fill=%22%23e0e0e0%22 width=%22100%22 height=%22120%22/><text x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 fill=%22%23999%22 font-size=%2212%22>1</text></svg>'">
            <img src="/review-2.png" alt="Image 2" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 120%22><rect fill=%22%23d4af37%22 width=%22100%22 height=%22120%22/><text x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 fill=%22white%22 font-size=%2212%22>2</text></svg>'">
            <img src="/review-3.png" alt="Image 3" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 120%22><rect fill=%22%23e0e0e0%22 width=%22100%22 height=%22120%22/><text x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 fill=%22%23999%22 font-size=%2212%22>3</text></svg>'">
            <img src="/review-4.png" alt="Image 4" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 120%22><rect fill=%22%23d4af37%22 width=%22100%22 height=%22120%22/><text x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 fill=%22white%22 font-size=%2212%22>4</text></svg>'">
        </div>

        <div class="review-labels">
            <div class="review-label-group">
                <span class="review-tag">üëÉ ‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏à‡∏°‡∏π‡∏Å</span>
                <p class="review-text">"‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥‡∏°‡∏≤‡∏Å ‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡πÉ‡∏ö‡∏´‡∏ô‡πâ‡∏≤"</p>
            </div>
            <div class="review-label-group">
                <span class="review-tag">üëÅÔ∏è ‡∏ó‡∏≥‡∏ï‡∏≤‡∏™‡∏≠‡∏á‡∏ä‡∏±‡πâ‡∏ô</span>
                <p class="review-text">"‡∏ï‡∏≤‡πÇ‡∏ï‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡∏î‡∏π‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á"</p>
            </div>
        </div>
    </section>

    <!-- ========== PROMO SECTION ========== -->
    <section class="promo-section">
        <div class="promo-box">
            <span class="promo-badge">üéÅ ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©</span>
            <h3 class="promo-title">‡πÅ‡∏≠‡∏î‡πÑ‡∏•‡∏ô‡πå‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ ‡∏£‡∏±‡∏ö‡∏ü‡∏£‡∏µ!</h3>
            <ul class="promo-list">
                <li>‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤ 100,000 ‡∏ß‡∏≠‡∏ô</li>
                <li>‡∏†‡∏≤‡∏û‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÉ‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î</li>
                <li>‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</li>
            </ul>
        </div>
    </section>

    <!-- ========== STICKY CTA ========== -->
    <div class="sticky-cta">
        <div class="sticky-cta-content">
            <div class="sticky-cta-text">
                <span class="highlight">üî• ‡∏à‡∏≥‡∏Å‡∏±‡∏î 5 ‡∏ó‡πà‡∏≤‡∏ô/‡∏ß‡∏±‡∏ô</span>
                <div class="main-text">‡∏™‡πà‡∏á‡∏£‡∏π‡∏õ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏´‡∏°‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ü‡∏£‡∏µ!</div>
            </div>
            <a href="https://line.me/R/ti/p/@duprs.th" class="sticky-cta-button" id="lineButton">
                <svg viewBox="0 0 24 24" fill="#00B900">
                    <path d="M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.627-.63h2.386c.349 0 .63.285.63.63 0 .349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.105.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.627-.63.349 0 .631.285.631.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.349 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.281.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314"/>
                </svg>
                ‡πÅ‡∏≠‡∏î‡πÑ‡∏•‡∏ô‡πå
            </a>
        </div>
    </div>

<script>
  // ====== Ïú†Ìã∏ ======
  // Î™®Î∞îÏùº ÎîîÎ∞îÏù¥Ïä§ Í∞êÏßÄ Ìï®Ïàò
  function isMobile() {
    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
  }

  // LINE URL: Î™®Î∞îÏùºÏùÄ line:// Ïä§ÌÇ¥, PCÎäî https://
  function getLineURL() {
    if (isMobile()) {
      return 'line://ti/p/@duprs.th';
    } else {
      return 'https://line.me/R/ti/p/@duprs.th';
    }
  }

  const LINE_URL = getLineURL();
  console.log('üì± ÎîîÎ∞îÏù¥Ïä§:', isMobile() ? 'Î™®Î∞îÏùº' : 'PC', '| LINE URL:', LINE_URL);

  function genEventId() {
    return 'cid-' + Date.now() + '-' + Math.random().toString(36).slice(2,10);
  }
  function getCookie(name) {
    const m = document.cookie.match(new RegExp('(?:^|; )' + name.replace(/([.$?*|{}()[]\\\/\+^])/g, '\\$1') + '=([^;]*)'));
    return m ? decodeURIComponent(m[1]) : '';
  }
  const COOKIE_MAX_AGE_DAYS = 180;

  function setCookie(name, value, days = COOKIE_MAX_AGE_DAYS) {
    const expires = new Date(Date.now() + days * 24 * 60 * 60 * 1000).toUTCString();
    document.cookie = `${name}=${value}; path=/; expires=${expires}; SameSite=Lax; Secure`;
  }

  function ensureFbpCookie() {
    if (!getCookie('_fbp')) {
      const newFbp = `fb.1.${Date.now()}.${Math.random().toString(36).slice(2,10)}`;
      setCookie('_fbp', newFbp);
      console.log('üßÅ _fbp Ïø†ÌÇ§ ÏÉùÏÑ±:', newFbp);
    }
  }

  function ensureFbcFromQuery() {
    const params = new URLSearchParams(location.search);
    const fbclid = params.get('fbclid');
    if (fbclid) {
      const newFbc = `fb.1.${Date.now()}.${fbclid}`;
      setCookie('_fbc', newFbc, 90);
      console.log('üßÅ _fbc Ïø†ÌÇ§ ÏÉùÏÑ± (fbclid Í∏∞Î∞ò):', newFbc);
    }
  }

  function getFbc() {
    return getCookie('_fbc') || '';
  }

  function checkPixelStatus() {
    console.log('üîç ÌîΩÏÖÄ ÏÉÅÌÉú ÌôïÏù∏:');
    console.log('  - fbq Ìï®Ïàò Ï°¥Ïû¨:', typeof window.fbq === 'function');
    console.log('  - fbq Í∞ùÏ≤¥ Ï°¥Ïû¨:', !!window.fbq);
    if (window.fbq) {
      console.log('  - fbq.queue Ï°¥Ïû¨:', !!window.fbq.queue);
      console.log('  - fbq.loaded:', window.fbq.loaded);
      console.log('  - fbq.version:', window.fbq.version);
    }
  }

  ensureFbcFromQuery();
  ensureFbpCookie();

  // ====== ÏÑúÎ≤Ñ CAPI Ï†ÑÏÜ° ======
  async function sendLeadToServer(eventId) {
    try {
      console.log('üì® sendLeadToServer() ÏãúÏûë, eventId:', eventId);

      const payload = {
        eventId,
        eventSourceUrl: location.href,
        email: '',
        phone: '',
        fbp: getCookie('_fbp') || '',
        fbc: getFbc(),
        userAgent: navigator.userAgent
      };

      console.log('üìã Ï†ÑÏÜ°Ìï† payload:', payload);
      console.log('üåê /api/lead ÏöîÏ≤≠ ÏãúÏûë...');

      const response = await fetch('/api/lead', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify(payload),
        keepalive: true
      });

      console.log('üì° ÏÑúÎ≤Ñ ÏùëÎãµ ÏÉÅÌÉú:', response.status);
      const result = await response.json();
      console.log('üìÑ ÏÑúÎ≤Ñ ÏùëÎãµ ÎÇ¥Ïö©:', result);
      console.log('üîç ÏÉÅÏÑ∏ Meta ÏùëÎãµ:', result.meta);

      if (response.ok) {
        console.log('‚úÖ CAPI Ï†ÑÏÜ° ÏÑ±Í≥µ!');
      } else {
        console.log('‚ùå CAPI Ï†ÑÏÜ° Ïã§Ìå®:', result);
      }
    } catch(e) {
      console.error('üö® CAPI Ï†ÑÏÜ° ÏóêÎü¨:', e);
    }
  }

  // ====== Î¶¨Îìú Ï†ÑÏÜ° ÌõÖ ======
  function trackLeadWithDedup() {
    console.log('üöÄ trackLeadWithDedup() Ìò∏Ï∂úÎê®');
    const eventId = genEventId();
    console.log('üìã ÏÉùÏÑ±Îêú eventId:', eventId);

    if (typeof window.fbq === 'function') {
      console.log('‚úÖ fbq Ìï®Ïàò Ï°¥Ïû¨ - Î∏åÎùºÏö∞Ï†Ä ÌîΩÏÖÄ Ï†ÑÏÜ°');
      fbq('trackCustom', 'LineFriendAdd', {}, { eventID: eventId });
      console.log('üìä Facebook Pixel LineFriendAdd(trackCustom) Ïù¥Î≤§Ìä∏ Ï†ÑÏÜ° ÏôÑÎ£å');
    } else {
      console.log('‚ùå fbq Ìï®Ïàò ÏóÜÏùå - ÌîΩÏÖÄ Î°úÎìú Ïã§Ìå®');
      if (window.fbq && window.fbq.queue) {
        window.fbq.queue.push(['track', 'LineFriendAdd', {}, { eventID: eventId }]);
        console.log('üìã Ïù¥Î≤§Ìä∏ ÌÅêÏóê LineFriendAdd Ïù¥Î≤§Ìä∏ Ï∂îÍ∞ÄÎê®');
      }
    }

    console.log('üåê ÏÑúÎ≤Ñ CAPI Ï†ÑÏÜ° ÏãúÏûë');
    sendLeadToServer(eventId);

    return eventId;
  }

  // DOM Î°úÎìú ÏôÑÎ£å ÌõÑ Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Îì±Î°ù
  function initEventListeners() {
    console.log('üîß Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï¥àÍ∏∞Ìôî ÏãúÏûë');
    checkPixelStatus();

    const lineBtn = document.getElementById('lineButton');
    if (lineBtn) {
      lineBtn.href = LINE_URL;
      console.log('‚úÖ ÎùºÏù∏ Î≤ÑÌäº Ï∞æÏùå - Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Îì±Î°ù');

      lineBtn.addEventListener('click', function(event) {
        event.preventDefault();
        console.log('üéØ ÎùºÏù∏ Î≤ÑÌäº ÌÅ¥Î¶≠Îê®');

        const eventId = trackLeadWithDedup();

        setTimeout(function() {
          window.location.href = LINE_URL;
        }, 1200);
      });
    } else {
      console.log('‚ùå ÎùºÏù∏ Î≤ÑÌäºÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏùå');
    }
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initEventListeners);
  } else {
    initEventListeners();
  }
</script>
</body>
</html>
